"use strict";var MaioInner=function(){function e(){this._setupCompleteCallbacks=new Array,this._isReady=!1,this._startTime=Date.now(),this._callbacks=new Array,this._adInfo=null}return e.prototype.onReady=function(e){void 0===e&&(e=null),null==e&&Exception.referenceNullException("action"),this._isReady?e(this._adInfo.isDefaultMute):null!=e&&this._setupCompleteCallbacks.push(e)},e.prototype.isReady=function(){return this._isReady},e.prototype.isDefaultMute=function(){return null==this._adInfo||this._adInfo.isDefaultMute},e.prototype.openClickUrl=function(e){null==e&&Exception.referenceNullException("clickUrl"),0!=this._isReady&&(this._sendViewLog(!0),this._openClickUrl(e))},e.prototype.closeAd=function(e){null==e&&Exception.referenceNullException("showEndCard"),0!=this._isReady&&(e=null!=this._adInfo.show_end_card?!!this._adInfo.show_end_card:!!e,this._sendViewLog(!0),this._closeAd(e))},e.prototype.getDeviceInfo=function(){return 0==this._isReady?null:this._adInfo.device},Object.defineProperty(e.prototype,"_viewTime",{get:function(){return Math.ceil((Date.now()-this._startTime)/1e3)},enumerable:!0,configurable:!0}),e.prototype._loadAdInfo=function(){var i=this;this._nativeApi("loadAdInfo",null,function(e){i._adInfo=e,i._isReady=!0,e.allowed_skip&&new SkipView(e,{onSkipClicked:function(){i._sendViewLog(!1),i._closeAd(!1)}});for(var t=0,n=i._setupCompleteCallbacks;t<n.length;t++){(0,n[t])(i._adInfo.isDefaultMute)}})},e.prototype._init=function(){this._loadAdInfo()},e.prototype._sendViewLog=function(e){var t;this._adInfo.view_completed_tracking_url?((t=this._createBaseLogForConversionTrace()).redirect_url=this._adInfo.view_completed_tracking_url,this._isEarlierThanAndroidSdk104()&&(t.redirect_url=encodeURIComponent(t.redirect_url))):t=this._createBaseLog(),t.view_time=this._viewTime,t.view_duration=1,t.view_completed=e,t.ec=this._adInfo.ec;var n=this._jsonToQueryString(t);this._nativeApi("sendViewLog",{queryString:n,async:!0})},e.prototype._openClickUrl=function(e){var t=this._createBaseLogForConversionTrace();t.redirect_url=e;var n=this._jsonToQueryString(t),i=this._adInfo.settings.log_click_url+"?"+n;this._nativeApi("openClickUrl",{url:i})},e.prototype._closeAd=function(e){this._nativeApi("closeAd",{showEndCard:e})},e.prototype._nativeCallback=function(e,t){this._callbacks[e](t),delete this._callbacks[e]},e.prototype._isEarlierThanAndroidSdk104=function(){var e=this._adInfo.device.plt;if(!e||"android"!=e.toLowerCase())return!1;var t=this._adInfo.device.sdkv;if(!t)return!0;switch(t.substr(0,5)){case"1.0.0":case"1.0.1":case"1.0.2":case"1.0.3":return!0}return!1},e.prototype._jsonToQueryString=function(e){var t=[];for(var n in e){var i=e[n];i=null==i?"":encodeURIComponent(i),n=encodeURIComponent(n),t.push(n+"="+i)}return t.join("&")},e.prototype._createBaseLogForConversionTrace=function(){var e=this._createBaseLog();return e.conversion_trace_mode=this._adInfo.conversionItems.conversion_trace_mode,e.ct_ctid_query_name=this._adInfo.conversionItems.ct_ctid_query_name,e.ct_amid_query_name=this._adInfo.conversionItems.ct_amid_query_name,e.ct_adid_query_name=this._adInfo.conversionItems.ct_adid_query_name,e.ct_cb_query_name=this._adInfo.conversionItems.ct_cb_query_name,e.ct_hzid_query_name=this._adInfo.conversionItems.ct_hzid_query_name,e.shzi=this._adInfo.conversionItems.shzi,e},e.prototype._createBaseLog=function(){var e={zone_id:this._adInfo.baseLogItems.zone_id,campaign_id:this._adInfo.baseLogItems.campaign_id,creative_id:this._adInfo.baseLogItems.creative_id,ad_media_id:this._adInfo.baseLogItems.ad_media_id};for(var t in this._adInfo.device)e[t]=this._adInfo.device[t];return e},e.prototype._nativeApi=function(t,n,e){void 0===n&&(n=null),void 0===e&&(e=null),e&&((n=n||{}).__callbackId=this._callbacks.push(e)-1);var i="";if(n)try{i=encodeURIComponent(JSON.stringify(n))}catch(e){t="log",n={message:e.message,error:e},i=encodeURIComponent(JSON.stringify(n))}this._loadFrame("native://"+t+"/"+i)},e.prototype._loadFrame=function(e){var t=document.createElement("iframe");t.setAttribute("height","1px"),t.setAttribute("width","1px"),t.setAttribute("frameborder","0"),t.setAttribute("src",e),document.documentElement.appendChild(t),t.parentNode.removeChild(t),t=null},e}(),Exception=function(){function e(){}return e.referenceNullException=function(e){throw new Error(e+" is null or undefined.")},e.indexOutOfBounds=function(e){throw new Error("Index is out of bounds: "+e)},e}(),Maio=new MaioInner;function native_callback(e,t){Maio._nativeCallback(e,t)}window.addEventListener("load",function(e){Maio._init()});var ElementUtils=function(){function e(){}return e.addClickEventListener=function(e,t){var n=!1;e.addEventListener(this.EVENT_NAME_TOUCH_START,function(){n=!0}),e.addEventListener(this.EVENT_NAME_TOUCH_END,function(){n&&(n=!1,t())})},e.IS_TOUCH_SUPPORTED="ontouchend"in document,e.EVENT_NAME_TOUCH_START=e.IS_TOUCH_SUPPORTED?"touchstart":"mousedown",e.EVENT_NAME_TOUCH_END=e.IS_TOUCH_SUPPORTED?"touchend":"mouseup",e}(),SkipView=function(){function e(n,e){var t=this;this._playerViewDelegate=e;var i=document.body,o=document.createElement("a");o.id="skip-button",o.style.padding="1% 0 0 2.5%",o.style.display="none",o.style.position="absolute",o.style.top="0",o.style.left="0",o.innerText="skip",this._setDefaultProperties(o),ElementUtils.addClickEventListener(o,function(){t._playerViewDelegate.onSkipClicked()}),i.appendChild(o);var a=document.createElement("span");a.id="until-skippable-video",a.style.padding="1% 0 0 2.5%",a.style.position="absolute",a.style.top="0",a.style.left="0",this._setDefaultProperties(a);var r=document.createElement("span");r.id="until-skippable-video-sec",r.innerText=""+n.skippable_after_sec,this._setDefaultProperties(r),a.appendChild(document.createTextNode("スキップ可能まで ")),a.appendChild(r),a.appendChild(document.createTextNode("秒"));var s=Date.now(),c=0,d=setInterval(function(){var e=Date.now(),t=Math.floor((e-s)/1e3);c<t&&(c=t,r.innerText=""+(n.skippable_after_sec-c),c>=n.skippable_after_sec&&(a.style.display="none",o.style.display="inline-block",clearInterval(d)))},100);setTimeout(function(){o.style.display="none"},1e3*n.force_view_seconds),i.appendChild(a)}return e.prototype._setDefaultProperties=function(e){e.style.userSelect="none",e.style.fontFamily='"Lucida Grande","Lucida Sans Unicode","Hiragino Kaku Gothic Pro","ヒラギノ角ゴ Pro W3","メイリオ",Meiryo,"ＭＳ Ｐゴシック",Helvetica,Arial,Verdana,sans-serif',e.style.color="#eee",e.style.textShadow="1px 1px 1px #000",e.style.zIndex="2147483647"},e}();